import{a as r}from"./react-vendor-CVdYNB31.js";import{ac as t,al as e,am as n,z as s,B as o,an as c,ao as u}from"./motion-BDAO4vxi.js";import{a,b as i,M as f}from"./index-DtAdbdqa.js";const l=()=>({scrollX:t(0),scrollY:t(0),scrollXProgress:t(0),scrollYProgress:t(0)}),g=r=>!!r&&!r.current;function p({container:t,target:s,...o}={}){const c=a(l),u=r.useRef(null),f=r.useRef(!1),p=r.useCallback(()=>(u.current=e((r,{x:t,y:e})=>{c.scrollX.set(t.current),c.scrollXProgress.set(t.progress),c.scrollY.set(e.current),c.scrollYProgress.set(e.progress)},{...o,container:t?.current||void 0,target:s?.current||void 0}),()=>{u.current?.()}),[t,s,JSON.stringify(o.offset)]);return i(()=>(f.current=!1,g(t)||g(s)?void(f.current=!0):p()),[p]),r.useEffect(()=>f.current?(n(!g(t)),n(!g(s)),p()):void 0,[p]),c}function m(e,n){const c=function(e){const n=a(()=>t(e)),{isStatic:s}=r.useContext(f);if(s){const[,t]=r.useState(e);r.useEffect(()=>n.on("change",t),[])}return n}(n()),u=()=>c.set(n());return u(),i(()=>{const r=()=>s.preRender(u,!1,!0),t=e.map(t=>t.on("change",r));return()=>{t.forEach(r=>r()),o(u)}}),c}function d(r,t,e,n){if("function"==typeof r)return function(r){c.current=[],r();const t=m(c.current,r);return c.current=void 0,t}(r);const s="function"==typeof t?t:u(t,e,n);return Array.isArray(r)?v(r,s):v([r],([r])=>s(r))}function v(r,t){const e=a(()=>[]);return m(r,()=>{e.length=0;const n=r.length;for(let t=0;t<n;t++)e[t]=r[t].get();return t(e)})}export{d as a,p as u};
